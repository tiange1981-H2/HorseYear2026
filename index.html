<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é©¬åˆ°æˆåŠŸ Â· ç»¿æ°¢æœªæ¥ - 2026æ‹œå¹´</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥å­—ä½“ -->
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@700&family=Noto+Sans+SC:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --brand-green: #10b981;
            --brand-blue: #3b82f6;
            --brand-gold: #fbbf24;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: #0f172a;
            /* æ·±è“è‰²èƒŒæ™¯ */
            color: #f8fafc;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calligraphy {
            font-family: 'Noto Serif SC', serif;
        }

        .glass-morphism {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        #posterCanvas {
            display: none;
        }

        .loading-dot {
            animation: blink 1.4s infinite both;
        }

        @keyframes blink {
            0% {
                opacity: .2;
            }

            20% {
                opacity: 1;
            }

            100% {
                opacity: .2;
            }
        }

        /* ç¡®ä¿å›¾ç‰‡åœ¨å®¹å™¨å†…å±•ç¤ºå®Œæ•´ */
        #finalPoster {
            max-width: 100%;
            max-height: 70vh;
            border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>

<body>

    <!-- ç¬¬ä¸€é˜¶æ®µï¼šè¾“å…¥è¡¨å• -->
    <div id="step-input" class="w-full max-w-md p-6 space-y-8 text-center">
        <div class="space-y-2">
            <h1 class="text-4xl font-bold tracking-tight text-emerald-400 calligraphy">é©¬å¹´å¤§å‰</h1>
            <p class="text-blue-300 opacity-80 uppercase tracking-widest text-xs">Power to X Â· ç»¿è‰²èƒ½æºæœªæ¥</p>
        </div>

        <div class="relative glass-morphism p-8 rounded-3xl space-y-6 shadow-2xl">
            <div class="space-y-3 text-left">
                <label class="text-xs font-semibold text-emerald-500 uppercase px-1">æ‚¨çš„å§“å/æ˜µç§°</label>
                <input type="text" id="userName" maxlength="6" placeholder="è¯·è¾“å…¥å§“å"
                    class="w-full bg-slate-900/80 border border-slate-700 rounded-2xl px-4 py-4 text-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all text-center text-white">
            </div>
            <button onclick="generatePoster()"
                class="w-full bg-gradient-to-r from-emerald-500 to-blue-600 hover:from-emerald-400 hover:to-blue-500 text-white font-bold py-4 rounded-2xl shadow-lg transform active:scale-95 transition-all text-lg">
                ç”Ÿæˆä¸“å±æµ·æŠ¥
            </button>
        </div>

        <p class="text-slate-500 text-xs">Â© 2026 ç”µæ°¢ç‡ƒæ–™åŒ–å­¦å“ Â· å“ç‰Œè‡´æ•¬</p>
    </div>

    <!-- ç¬¬äºŒé˜¶æ®µï¼šç”Ÿæˆä¸­ -->
    <div id="step-loading" class="hidden flex flex-col items-center space-y-6">
        <div class="w-16 h-16 border-4 border-emerald-500/20 border-t-emerald-500 rounded-full animate-spin"></div>
        <div class="text-center">
            <p class="text-emerald-400 calligraphy text-2xl">æ­£åœ¨åˆæˆç»¿è‰²æµ·æŠ¥</p>
            <p class="text-slate-500 text-sm mt-2">æ­£åœ¨ä»ç”µè§£æ§½æå–æ°¢æ°”èƒ½é‡...</p>
        </div>
    </div>

    <!-- ç¬¬ä¸‰é˜¶æ®µï¼šç»“æœå±•ç¤º -->
    <div id="step-result" class="hidden w-full max-w-md p-4 flex flex-col items-center space-y-6">
        <div class="relative group">
            <img id="finalPoster" src="" alt="æ‹œå¹´æµ·æŠ¥">
            <div class="mt-4 text-center">
                <p class="bg-emerald-500/20 text-emerald-400 px-4 py-2 rounded-full text-sm inline-block animate-pulse">
                    ğŸ’¡ é•¿æŒ‰ä¸Šæ–¹å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œ
                </p>
            </div>
        </div>

        <button onclick="location.reload()"
            class="bg-slate-800 hover:bg-slate-700 text-slate-300 px-6 py-3 rounded-xl transition-all flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
            æ¢ä¸ªæ ·å¼é‡æ–°ç”Ÿæˆ
        </button>
    </div>

    <canvas id="posterCanvas" width="800" height="1200"></canvas>

    <script>
        // ç¡®ä¿æ•°ç»„é¡ºåºä¸ extracted cards (card_01 ~ card_14) çš„å†…å®¹ä¸€è‡´
        // å›¾ç‰‡é¡ºåºï¼šRow 1 (4), Row 2 (5), Row 3 (5)
        const blessings = [
            "é©¬åˆ°æˆåŠŸï¼Œç»¿æ°¢åŠ©åŠ›ï¼", // 01
            "é¾™é©¬ç²¾ç¥ï¼Œå‡€é›¶æœªæ¥ï¼", // 02
            "ç­–é©¬æ‰¬é­ï¼Œåˆæˆç»¿è‰²æ–°ç¯‡ï¼", // 03
            "é©¬å¹´å¤§å‰ï¼Œç»¿ç”µæ°¢æ˜¥ï¼", // 04
            "å¿—åœ¨åƒé‡Œï¼Œæ°¢å¯æ–°ç¨‹ï¼", // 05
            "ä¸€é©¬å½“å…ˆï¼Œç¢³è·¯é¢†å…ˆï¼", // 06
            "ä¸‡é©¬å¥”è…¾ï¼Œé›¶ç¢³è¿œå¾ï¼", // 07
            "é©¬åŠ›å…¨å¼€ï¼Œæ™ºé€ ç»¿èƒ½ï¼", // 08
            "è·ƒé©¬äº‰å…ˆï¼Œå…±ç­‘é’å·ï¼", // 09
            "é©¬è¸é£ç‡•ï¼Œæ°¢é£æ‹‚é¢ï¼", // 10
            "åƒé‡Œé©¬å¸¸æœ‰ï¼Œç»¿æ°¢æ›´é•¿ä¹…ï¼", // 11
            "é©°éª‹æœªæ¥ï¼Œé›¶ç¢³è¡¨ç‡ï¼", // 12
            "é©¬å¹´äº¨é€šï¼Œæ°¢é€šå››æµ·ï¼", // 13
            "éªè…¾ä¸‡é‡Œï¼Œç»¿è‰²åŠ¨åŠ›ï¼"  // 14
        ];

        // ç´¢å¼•å¯¹åº” 0-13

        async function generatePoster() {
            const name = document.getElementById('userName').value.trim();
            if (!name) {
                alert("è¯·è¾“å…¥æ‚¨çš„å§“å");
                return;
            }

            // åˆ‡æ¢åˆ°åŠ è½½çŠ¶æ€
            document.getElementById('step-input').classList.add('hidden');
            document.getElementById('step-loading').classList.remove('hidden');

            const canvas = document.getElementById('posterCanvas');
            const ctx = canvas.getContext('2d');

            // éšæœºé€‰æ‹©ä¸€ä¸ªç´¢å¼• (0 ~ 13)
            const index = Math.floor(Math.random() * blessings.length);
            const blessingText = blessings[index];
            // å›¾ç‰‡è·¯å¾„ (æ³¨æ„æ–‡ä»¶å card_01.jpg åˆ° card_14.jpg)
            const imgIndex = (index + 1).toString().padStart(2, '0');
            const bgUrl = `assets/cards/card_${imgIndex}.jpg`;

            const img = new Image();
            img.crossOrigin = "anonymous";
            img.src = bgUrl;

            img.onload = function () {
                try {
                    // --- 1. èƒŒæ™¯å¡«å…… (æ·±è“å“ç‰Œè‰²) ---
                    ctx.fillStyle = '#0f172a';
                    ctx.fillRect(0, 0, 800, 1200);

                    // --- 2. ç»˜åˆ¶å¡ç‰‡ (å±…ä¸­) ---
                    // å¡ç‰‡æ˜¯æ¨ªç‰ˆæˆªå›¾ï¼Œç”»å¸ƒæ˜¯ç«–ç‰ˆã€‚ä¿æŒæ¯”ä¾‹ç»˜åˆ¶ã€‚
                    // å‡è®¾å¡ç‰‡æ¯”ä¾‹çº¦ 4:3 æˆ– 16:9ã€‚
                    // è®¾å®šç›®æ ‡å®½åº¦ 740 (ç•™è¾¹ 30)ï¼Œæ ¹æ®æ¯”ä¾‹ç®—é«˜åº¦ã€‚
                    const targetW = 740;
                    const aspect = img.height / img.width;
                    const targetH = targetW * aspect;
                    const targetX = 30;
                    const targetY = (1200 - targetH) / 2; // å‚ç›´å±…ä¸­

                    // ç”»ä¸ªå‘å…‰åº•åº§/é˜´å½±æå‡å±‚æ¬¡æ„Ÿ
                    ctx.shadowColor = "rgba(16, 185, 129, 0.5)"; // ç»¿è‰²å…‰æ™•
                    ctx.shadowBlur = 40;
                    ctx.fillStyle = '#1e293b';
                    ctx.fillRect(targetX - 10, targetY - 10, targetW + 20, targetH + 20);
                    ctx.shadowBlur = 0; // é‡ç½®

                    // ç»˜åˆ¶å…·ä½“å›¾ç‰‡
                    ctx.drawImage(img, targetX, targetY, targetW, targetH);

                    // --- 3. è£…é¥°è¾¹æ¡† ---
                    ctx.strokeStyle = 'rgba(251, 191, 36, 0.3)'; // é‡‘è‰²
                    ctx.lineWidth = 2;
                    ctx.strokeRect(20, 20, 760, 1160);

                    // --- 4. ç»˜åˆ¶å§“å (é¡¶éƒ¨åŒºåŸŸ) ---
                    ctx.textAlign = 'center';

                    // "ç¥" å­— -> "æ•¬ç¥"
                    ctx.fillStyle = '#94a3b8'; // æµ…ç°
                    ctx.font = '30px "Noto Sans SC"';
                    ctx.fillText('ç”µæ°¢ç‡ƒæ–™åŒ–å­¦å“ç¾¤ æ•¬ç¥ï¼š', 400, 150);

                    // åå­—
                    ctx.fillStyle = '#fbbf24'; // é‡‘è‰²
                    ctx.shadowColor = 'rgba(0,0,0,0.5)';
                    ctx.shadowBlur = 10;
                    ctx.font = 'bold 80px "Noto Serif SC", serif';
                    ctx.fillText(name, 400, 240);

                    // --- 5. åº•éƒ¨å“ç‰Œä¸Slogan ---
                    // å›¾ç‰‡ä¸‹æ–¹ç•™ç™½åŒºåŸŸ
                    const bottomAreaY = targetY + targetH;

                    // Slogan (æ—¢ç„¶å›¾ç‰‡ä¸Šæœ‰ç¥ç¦è¯­ï¼Œè¿™é‡Œå†™é€šç”¨çš„)
                    ctx.shadowBlur = 0;
                    ctx.fillStyle = '#ffffff';
                    ctx.font = '36px "Noto Sans SC"';
                    ctx.fillText("é©¬åˆ°æˆåŠŸ Â· ç»¿æ°¢æœªæ¥", 400, 1080);

                    ctx.fillStyle = '#10b981';
                    ctx.font = '24px monospace';
                    ctx.fillText('POWER TO X Â· 2026', 400, 1130);

                    // 8. è½¬åŒ–ä¸ºå›¾ç‰‡
                    const dataUrl = canvas.toDataURL('image/png');
                    const finalImg = document.getElementById('finalPoster');
                    finalImg.src = dataUrl;

                    // æ˜¾ç¤ºç»“æœ
                    document.getElementById('step-loading').classList.add('hidden');
                    document.getElementById('step-result').classList.remove('hidden');
                } catch (e) {
                    console.error(e);
                    alert("æµ·æŠ¥ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–å°è¯•ä½¿ç”¨å…¶ä»–å§“åã€‚");
                    location.reload();
                }
            };

            img.onerror = function () {
                alert("èƒŒæ™¯èµ„æºåŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œç¯å¢ƒæˆ–åˆ·æ–°é¡µé¢ã€‚");
                location.reload();
            };
        }
    </script>
</body>

</html>